"use strict";var Boplex={};!function(n){function t(n){var t=/function (.{1,})\(/,e=t.exec(n);return e&&e.length>1?e[1]:""}function e(n,t,e){n[e]=t}function o(n,t){return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n}function i(n){n=n||new Date;var t=n.getFullYear()+"."+(n.getMonth()+1)+"."+n.getDate()+"_"+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds();return t}function r(n,t,e){Object.defineProperty(n,t,{writable:!1,value:e})}function a(n,t){return n+Math.round(Math.random()*(t-n))}function c(n){n.getFuncName=t,n.defineConstProp=r,n.include=e,n.inherit=o,n.getLogTime=i,n.random=a}var u="0.0.3";r(n,"Version",u),c(n)}(Boplex),function(n){function t(){"obsolete"}function e(n){n.BaseObject=t}e(n)}(Boplex),function(n){function t(e){var o=e;t.prototype.log=function(t){console.log(n.getLogTime()+" "+o+" "+t)}}function e(n){n.Logger=t}e(n)}(Boplex),function(n){function t(n,e){var o=n,i=e;t.prototype.raise=function(n){i&&i(o,n)}}function e(n){n.Event=t}e(n)}(Boplex);var FunnyRain={};!function(n){Boplex.defineConstProp(n,"Version","0.0.1"),n.Physics={},n.Graphics={}}(FunnyRain),function(n){function t(t){function e(){f=new n.Physics.RainWorld({onDestroyBody:s}),d=new n.Graphics.View,$(l).append(d.getView()),y=new n.Graphics.AnimFrame(c,u),$(document).on("dblclick touchstart",o)}function o(n){if(!p)return void r();var t=i(n.clientX,n.clientY);(!t||t&&h)&&a(),t&&t.onDblClick&&t.onDblClick(n)}function i(n,t){var e=f,o=e.findBody(n,t);return o.block}function r(){p=!0,h=!1,f.setIsPaused(!1)}function a(){h=!h,f.setIsPaused(!f.getIsPaused())}function c(n,t,e){d.setScale(n,t,e)}function u(){f.step(),d.step()}function s(n,t){}var l=t,y=null,d=null,f=null,p=!1,h=!1;e()}n.Game=t}(FunnyRain),function(n){function t(n){function e(){var n=new Box2D.Common.Math.b2Vec2(w.gravity.x,w.gravity.y);g=new Box2D.Dynamics.b2World(n,!0)}function o(n){return n/w.RATIO}function i(n){var t={width:50,height:50,x:0,y:-60,restitution:.3,friction:10,density:1},e=$.extend({},t,n),i=new Box2D.Dynamics.b2BodyDef;i.type=Box2D.Dynamics.b2Body.b2_dynamicBody,i.position.Set(o(e.x),o(e.y));var r=g.CreateBody(i),a=new Box2D.Dynamics.b2FixtureDef;return a.shape=new Box2D.Collision.Shapes.b2PolygonShape,a.shape.SetAsBox(o(e.width),o(e.height)),a.density=e.density,a.restitution=e.restitution,a.friction=e.friction,r.CreateFixture(a),r}function r(n,t,e,o){var i=new Box2D.Dynamics.b2BodyDef;i.position.Set(n,t);var r=g.CreateBody(i),a=new Box2D.Dynamics.b2FixtureDef;return a.shape=new Box2D.Collision.Shapes.b2PolygonShape,a.shape.SetAsBox(e,o),a.density=1,r.CreateFixture(a),r}function a(){var n={timeStep:1/60,velocityIterations:8,positionIterations:4},t=n.timeStep;B&&(t=0),g.Step(t,n.velocityIterations,n.positionIterations),g.DrawDebugData(),g.ClearForces(),l()}function c(n){B=n}function u(){return B}function s(){return w.RATIO}function l(){x.forEach(function(n){g.DestroyBody(n)}),x=[]}function y(n){new Boplex.Event(null,m).raise(n),x.push(n)}function d(n,t){var e=new Box2D.Collision.b2AABB;return e.lowerBound.Set(n.x-t,n.y-t),e.upperBound.Set(n.x+t,n.y+t),e}function f(n,t){var e={size:w.bodySize},o=n.GetPosition();return t.x>=o.x&&t.x<=o.x+e.size&&t.y>=o.y&&t.y<=o.y+e.size}function p(n,t){var e,i={radius:w.bodySize},r=new Box2D.Common.Math.b2Vec2(o(n),o(t)),a=d(r,o(i.radius));return g.QueryAABB(function(n){var t=n.GetBody();return t.GetType()===Box2D.Dynamics.b2Body.b2_dynamicBody&&f(t,r)?(e=t,!1):!0},a),e}function h(n,t){function e(i){for(var r=i.GetContactList();r;){var a=r.other;!a.group&&t(a,n)&&(o.push(a),a.group=o,e(a)),r=r.next}}var o=[n];return n.group=o,e(n),o}var g,v=(new Boplex.Logger("FunnyRain.Physics.BaseWorld"),{RATIO:50,gravity:{x:0,y:0},onDestroyBody:null}),w=$.extend({},v,n),x=[],m=w.onDestroyBody,B=!1;e(),t.prototype.b2m=function(n){return o.call(this,n)},t.prototype.getBox2dWorld=function(){return g},t.prototype.setIsPaused=function(n){c.call(this,n)},t.prototype.getIsPaused=function(){return u.call(this)},t.prototype.step=function(){a.call(this)},t.prototype.getScale=function(){return s.call(this)},t.prototype.createWall=function(n,t,e,o){return r.call(this,n,t,e,o)},t.prototype.createDynamicBody=function(n){return i.call(this,n)},t.prototype.findBody=function(n,t){return p.call(this,n,t)},t.prototype.destroyBody=function(n){return y.call(this,n)},t.prototype.getMatchGroup=function(n,t){return h.call(this,n,t)}}n.Physics.BaseWorld=t}(FunnyRain),function(n){function t(e){function o(n){i(n)}function i(n){var t={wallSize:10,bottomPadding:100,leftPadding:0,rightPadding:100},e=n.b2m,o=n.createWall;o(0,e(c.canvasSize.y-t.bottomPadding),e(c.canvasSize.x),e(t.wallSize)),o(e(t.leftPadding),0,e(t.wallSize),e(c.canvasSize.y)),o(e(c.canvasSize.x-t.rightPadding),0,e(t.wallSize),e(c.canvasSize.y))}function r(n,t){var e={width:c.bodySize,height:c.bodySize,x:t||0,y:-60,restitution:.3,friction:10,density:1},o=n.createDynamicBody(e);return o}var a={canvasSize:{x:1600,y:1200},gravity:{x:0,y:9.8},bodySize:50},c=$.extend({},a,e);n.Physics.BaseWorld.call(this,c),o(this),t.prototype.createBody=function(n){return r.call(this,this,n)}}n.Physics.RainWorld=Boplex.inherit(t,n.Physics.BaseWorld)}(FunnyRain),function(n){function t(n,t,e){function o(){var n=$(window).innerWidth(),t=$(window).innerHeight();r(n,t)}function i(){requestAnimationFrame(i),c()}function r(n,t){var e=1,o=s.canvasSize,i=n/o.x,r=t/o.y;e=i>1||r>1?1:r>i?i:r;var c=e*o.x,u=e*o.y;a(e,c,u)}var a=n,c=t,u=(new Boplex.Logger("FunnyRain.AnimFrame"),{canvasSize:{x:1600,y:1200},dpr:window.devicePixelRatio}),s=$.extend({},u,e);!function(){i(),$(window).on("resize deviceOrientation",o),$(window).trigger("resize")}(),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}()}n.Graphics.AnimFrame=t}(FunnyRain),function(n){function t(n){function e(n){var t=h.assetsDir+n+".png";return t}function o(){d=PIXI.autoDetectRenderer(h.canvasSize.x,h.canvasSize.y,{backgroundColor:h.backgroundColor}),f=a(h.backgroundImage),i()}function i(){}function r(n){var t=e(n),o=new PIXI.Sprite.fromImage(t);return o}function a(n){var t=r(n),e=new PIXI.Container;return e.addChild(t),e.sprite=t,e}function c(n){var t=a(n);return f.addChild(t),t}function u(n){if(n){var t=n.parent;t&&t.removeChild(n)}}function s(){return d.view}function l(n,t,e){f.scale.x=f.scale.y=n,d.resize(t,e)}function y(){d.render(f)}var d,f,p=(new Boplex.Logger("FunnyRain.Graphics.View"),{canvasSize:{x:1600,y:1200},backgroundColor:1087931,assetsDir:"assets/",backgroundImage:"background"}),h=$.extend({},p,n);o(),t.prototype.step=function(){y.call(this)},t.prototype.setScale=function(n,t,e){l.call(this,n,t,e)},t.prototype.getView=function(){return s.call(this)},t.prototype.createActor=function(n){return c.call(this,n)},t.prototype.destroyActor=function(n){return u.call(this,n)}}n.Graphics.View=t}(FunnyRain),console.log("Testing FunnyRain... "),console.dir(FunnyRain),console.log("Test completed!");